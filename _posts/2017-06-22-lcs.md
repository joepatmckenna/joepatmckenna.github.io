---
layout: post
title:  coherent structures in the wind
date:   2017-06-22
categories: 
- fluids 
- coherent structures
- wind
mathjax: true
comments: true
---

Something I like to do at large research conferences is drop into sessions with intriguing titles about topics unfamiliar to me. At the last SIAM Conference on applications of dynamical systems, I dropped into "Set Oriented and Transfer Operator Methods for Turbulent Flows". I learned about an appealing visualization tool called *finite time Lyapunov exponent fields* that I'll explain below. The speakers presented more advanced topics that I won't mention.

Turbulence "is a flow regime in fluid dynamics characterized by chaotic changes in pressure and flow velocity (wikipedia: Turbulence)." Datasets examined by the speakers included ocean currents and particle tracers in a controlled laboratory water flow. Researchers in the field approach the broad question "How do turbulent fluid flows evolve over time?" and commonly use the approach of tracking coherent structures in the flow. Coherent structures are distinguished trajectories that exert a major influence on the overall flow. Examples of coherent structures include the water vortices classically illustrated by Leonardo da Vinci.

To my understanding, traditional approaches classify coherent structures with respect to the reference frame of a basis for the flow domain, yielding *Eulerian* coherent structures, but more recent approaches classify them with respect to the reference frame of the flow itself, yielding *Lagrangian* coherent structures.

Proper orthogonal decomposition, which refers to computing the SVD of a data matrix whose columns are vectorized grids of observables from the flow at different time points, is a workhorse for detecting Eulerian coherent structures. The strongest modes of the SVD correspond to coherent structures and can appear as, say, vortices in the flow. 

From dynamical systems theory, invariant manifolds emanate from the equilibria in flows generated by time-independent vector fields. These manifolds, and other Lagrangian coherent structures, partition the state space. They offer a powerful tool for understanding the entire flow since the asymptotic fate of any initial condition can be classified by simply identifying the state space partition in which it begins.

Many real-world flows, however, are generated by time-dependent vector fields and often lack equilibria, so the theory of time-independent invariant manifolds does not apply. A computational approach to approximate analogous separatrices in flows generated by time-dependent vector fields is to identify ridges in the finite time Lyapunov exponent fields. As I will explain below, the finite time Lyapunov exponent quantifies at each point in space the degree to which nearby points diverge when advected by the flow. Ridges in the finite time Lyapunov exponent field act as barriers that partition the flow into sections that tend not to mix.

I'll make my explanation of finite time Lyapunov exponents more precise and then present this appealing visualization for a wind vector dataset.

Let $F:U\times[-c,c]\rightarrow M$, defined by $F(x_0;t)=x(t)$, be the flow that takes an initial condition $x_0\in U$ at time $t_0=0$ to position $x(t)$ at time $t\in[-c,c]$, where $U$ is an open set of manifold $M$ and $c$ is a real number. A trajectory of $F$ with initial condition $x_0$ perturbed by $\Delta x_0$ evolves with the flow by $F(x_0+\Delta x_0;t)=x(t)+\Delta x(t)$. Expanding the lefthand side about $x_0$ yields a linear approximation $$\Delta x(t)\approx\nabla F(x_0;t)\Delta x_0$$ of the evolving perturbation $\Delta x(t)$. Assuming $\|\|\Delta x_0\|\|=1$, the squared-magnitude of the evolving perturbation

\begin{equation}\label{eq:rayleigh}
\|\|\Delta x(t)\|\|_2^2\approx\Delta x_0^T\nabla F(x_0;t)^T\nabla F(x_0;t)\Delta x_0
\end{equation}

is bounded by the magnitude of the maximum eigenvalue of $\nabla F(x_0;t)^T \nabla F(x_0;t)$ since the righthand side of \eqref{eq:rayleigh} a the Rayleigh quotient of $\nabla F^T\nabla F$ (a matrix called the *right Cauchy-Green deformation tensor*). The scalar field

\begin{equation}\label{eq:ftle}
\sigma(x;t)={1 \over |t|}\ln\sqrt{\lambda_{\max}(\nabla F(x;t)^T\nabla F(x;t))},
\end{equation}

where $\lambda_{\max}(\cdot)$ stands for maximum eigenvalue, is called the *finite time Lyapunov exponent field* of $F$ parameterized by $t$.

Elevated ridges in $\sigma(x;t)$ approximate stable manifolds that separate nearby trajectories in the flow. Think of a saddle equilibrium in a two-dimensional flow generated by a time-independent vector field. Two initial conditions on other side of the saddle stable manifold tend toward opposite branches of the saddle unstable manifold, resulting in high finite time Lyapunov exponent values near the stable manifold. Especially in the context of flows generated by time-dependent vector fields, these ridges are examples of Lagrangian coherent structures.

Computing \eqref{eq:ftle} requires being able to compute the flow $F$ and its first derivatives. This can be done directly from data. In particular, numerical integration can be used to evolve the flow while interpolation is used to evaualuate it over the whole domain of interest. Then, numerical differentiation can be used to approximate $\nabla F$.

I compute $\sigma(x;t)$ for global wind flow using [this dataset][dataset] that collects satellite measurements on a global grid of wind vectors at 6-hr time resolution for 25 years. Here's an example of the data for the two weeks preceding and following hurricane Katrina. You can see the hurricane as a rogue gust about halfway through the video.

{% include video.html src="/vid/katrina_vf.mp4" height="320" width="640" %}

{% include video.html src="/vid/katrina_lcs.mp4" height="320" width="640" %}


[dataset]: https://podaac.jpl.nasa.gov/dataset/CCMP_MEASURES_ATLAS_L4_OW_L3_0_WIND_VECTORS_FLK
